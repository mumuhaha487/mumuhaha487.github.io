<!doctype html>
<html lang="en-us">
  <head>
    <title>用python从零开始做一个最简单的小说爬虫带GUI界面（2/3） // 木哈文轩</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.123.3">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="木木em哈哈" />
    <meta name="description" content="文章浏览阅读763次。前一章博客我们讲了怎么通过PyQt5来制作图形化界面，并且进行一些基本设置接下来两章我们主要讲核心爬虫代码的实现。_python爬取书旗小说代码gui" />
    <link rel="stylesheet" href="/css/main.min.a545955c4c2a15328ae3f208fda979c3a40146d5a6d4f95e0ab1a00e48cd1ff2.css" />
    

    
    <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="用python从零开始做一个最简单的小说爬虫带GUI界面（2/3）"/>
<meta name="twitter:description" content="文章浏览阅读763次。前一章博客我们讲了怎么通过PyQt5来制作图形化界面，并且进行一些基本设置接下来两章我们主要讲核心爬虫代码的实现。_python爬取书旗小说代码gui"/>

    <meta property="og:title" content="用python从零开始做一个最简单的小说爬虫带GUI界面（2/3）" />
<meta property="og:description" content="文章浏览阅读763次。前一章博客我们讲了怎么通过PyQt5来制作图形化界面，并且进行一些基本设置接下来两章我们主要讲核心爬虫代码的实现。_python爬取书旗小说代码gui" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://0ha.top/posts/132457770/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-24T03:30:46+00:00" />
<meta property="article:modified_time" content="2023-08-24T03:30:46+00:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="https://0ha.top/"><img class="app-header-avatar" src="https://s3.bmp.ovh/imgs/2024/02/27/ebc3b3191cd37c75.jpg" alt="木木em哈哈" /></a>
      <span class="app-header-title">木哈文轩</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">主页</a>
              ·  
          
          <a class="app-header-menu-item" href="/tags/">标签</a>
              ·  
          
          <a class="app-header-menu-item" href="/about/">有关</a>
      </nav>
      <p>别让我逮住嗷</p>
      <div class="app-header-social">
        
          <a href="https://blog.csdn.net/mumuemhaha" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-circle">
  <title>CSDN</title>
  <circle cx="12" cy="12" r="10"></circle>
</svg>
          </a>
        
          <a href="https://github.com/mumuhaha487" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">用python从零开始做一个最简单的小说爬虫带GUI界面（2/3）</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Aug 24, 2023
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <p><strong>目录</strong></p>
<p><a href="#%e5%89%8d%e4%b8%80%e7%ab%a0%e5%8d%9a%e5%ae%a2">前一章博客</a></p>
<p><a href="#%e5%89%8d%e8%a8%80">前言</a></p>
<p><a href="#%e4%b8%bb%e5%87%bd%e6%95%b0%e7%9a%84%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0">主函数的代码实现</a></p>
<p><a href="#%e9%80%90%e8%a1%8c%e4%bb%a3%e7%a0%81%e8%a7%a3%e6%9e%90">逐行代码解析</a></p>
<p><a href="#%e8%8e%b7%e5%8f%96%e9%93%be%e6%8e%a5">获取链接</a></p>
<p><a href="#%e8%8e%b7%e5%8f%96%e6%a0%87%e9%a2%98">获取标题</a></p>
<p><a href="#%e8%8e%b7%e5%8f%96%e7%bd%91%e9%a1%b5%e6%ba%90%e4%bb%a3%e7%a0%81">获取网页源代码</a></p>
<p><a href="#%e8%8e%b7%e5%8f%96%e5%90%84%e4%b8%aa%e6%96%87%e7%ab%a0%e7%9a%84%e9%93%be%e6%8e%a5">获取各个文章的链接</a></p>
<p><a href="#%e5%87%bd%e6%95%b0%e7%9a%84%e4%bb%a3%e7%a0%81">函数的代码</a></p>
<p><a href="#%e5%af%bc%e5%85%a5%e5%ba%93%e6%96%87%e4%bb%b6">导入库文件</a></p>
<p><a href="#%e8%8e%b7%e5%8f%96%e6%96%87%e7%ab%a0%e7%9a%84%e6%a0%87%e9%a2%98">获取文章的标题</a></p>
<p><a href="#%e8%8e%b7%e5%8f%96%e6%96%87%e7%ab%a0%e7%9a%84%e6%ba%90%e4%bb%a3%e7%a0%81">获取文章的源代码</a></p>
<p><a href="#%e6%8f%90%e5%8f%96%e6%96%87%e7%ab%a0%e7%9b%ae%e5%bd%95%e7%9a%84%e5%90%84%e4%b8%aa%e6%96%87%e7%ab%a0%e7%9a%84%e9%93%be%e6%8e%a5">提取文章目录的各个文章的链接</a></p>
<p><a href="#%e6%80%bb%e4%bb%a3%e7%a0%81">总代码</a></p>
<p><a href="#%e4%b8%8b%e4%b8%80%e7%ab%a0%e5%86%85%e5%ae%b9">下一章内容</a></p>
<h2 id="前一章博客">前一章博客</h2>
<p><a href="https://blog.csdn.net/mumuemhaha/article/details/132394257?spm=1001.2014.3001.5501" title="用python从零开始做一个最简单的小说爬虫带GUI界面（1/3)_木木em哈哈的博客-CSDN博客">用python从零开始做一个最简单的小说爬虫带GUI界面（1/3)_木木em哈哈的博客-CSDN博客而且当时的爬虫代码有许多问题但是最近学了PyQt5想着搞个带界面的爬虫玩玩那就啥也不说开搞！！！<img src="https://g.csdnimg.cn/static/logo/favicon32.ico" alt="">https://blog.csdn.net/mumuemhaha/article/details/132394257?spm=1001.2014.3001.5501 ;</a></p>
<h2 id="前言">前言</h2>
<p>前一章博客我们讲了怎么通过PyQt5来制作图形化界面，并且进行一些基本设置</p>
<p>接下来两章我们主要讲核心爬虫代码的实现</p>
<p><img src="https://0ha.top/img/ca6dac55f59042f589bfaab11d54d26b.gif" alt=""></p>
<h2 id="主函数的代码实现">主函数的代码实现</h2>
<p>前一章中的代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>self<span style="color:#f92672">.</span>Button_run<span style="color:#f92672">.</span>clicked<span style="color:#f92672">.</span>connect(self<span style="color:#f92672">.</span>F_run)
</span></span></code></pre></div><p>代表点击按钮执行F_run函数（注意这里不要打括号）</p>
<p>那么我们就需要定义这个函数</p>
<p>思路大概就是这样</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">F_run</span>(self):
</span></span><span style="display:flex;"><span>        link_1<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>line_link<span style="color:#f92672">.</span>text()
</span></span><span style="display:flex;"><span>        title_1<span style="color:#f92672">=</span>F_gettitle(link_1)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>text_result<span style="color:#f92672">.</span>setText(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;标题获取成功——</span><span style="color:#e6db74">{</span>title_1<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># file_1=open(f&#39;{title_1}.txt&#39;,mode=&#39;w&#39;,encoding=&#39;utf-8  &#39;)</span>
</span></span><span style="display:flex;"><span>        test_1<span style="color:#f92672">=</span>F_getyuan(link_1)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>text_result<span style="color:#f92672">.</span>setText(<span style="color:#e6db74">&#34;提取源代码成功&#34;</span>)
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        search_1<span style="color:#f92672">=</span>F_searchlink(test_1)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>text_result<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#34;提取文章链接成功&#34;</span>)
</span></span><span style="display:flex;"><span>        pachong(search_1,title_1)
</span></span></code></pre></div><h3 id="逐行代码解析">逐行代码解析</h3>
<h4 id="获取链接">获取链接</h4>
<p>首先通过</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>self<span style="color:#f92672">.</span>line_link<span style="color:#f92672">.</span>text()
</span></span></code></pre></div><p>命令获取在输入框中输入的链接</p>
<p>并且把它赋值到link_1中</p>
<h4 id="获取标题">获取标题</h4>
<p>同时我会通过爬取网页链接的源代码进行提取关键字获得文章的标题</p>
<p>也就是小说的名字</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>title_1<span style="color:#f92672">=</span>F_gettitle(link_1)
</span></span></code></pre></div><h4 id="获取网页源代码">获取网页源代码</h4>
<p>爬取小说文章目录网页的源代码并且赋值为test_1（用于后续提取各个文章的链接）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>test_1<span style="color:#f92672">=</span>F_getyuan(link_1)
</span></span></code></pre></div><h4 id="获取各个文章的链接">获取各个文章的链接</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>search_1<span style="color:#f92672">=</span>F_searchlink(test_1)
</span></span></code></pre></div><p>把得到的源代码进行提取筛选获得各个文章的链接</p>
<p>其中self.text_result.setText以及self.text_result.append是在下面红圈中显示的东西</p>
<p>（美观用，可以不加）</p>
<p><img src="https://0ha.top/img/66e83cfe9601446e9ddbb3e07e888dd7.png" alt=""></p>
<h2 id="函数的代码">函数的代码</h2>
<p>这里为了不让代码过于长，我自己有单独新建了两个python文件用于存放python函数</p>
<h3 id="导入库文件">导入库文件</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span></code></pre></div><p>request用于网络请求</p>
<p>re以及lxml用于过滤源代码的信息</p>
<p>而numpy用于存储元素</p>
<h3 id="获取文章的标题">获取文章的标题</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">F_gettitle</span>(link_0):
</span></span><span style="display:flex;"><span>    head_qb<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;User-Agent&#39;</span>:<span style="color:#e6db74">&#39;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Mobile Safari/537.36&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    test_1<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>link_0,headers<span style="color:#f92672">=</span>head_qb)
</span></span><span style="display:flex;"><span>    test_yuan<span style="color:#f92672">=</span>test_1<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>    dom<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(test_yuan)
</span></span><span style="display:flex;"><span>    test_2<span style="color:#f92672">=</span>dom<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;/html/body/article[1]/div[2]/div[2]/h1/text()&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> test_2[<span style="color:#ae81ff">0</span>]
</span></span></code></pre></div><p>很简单的一个的结构</p>
<p>由requests来获取源代码</p>
<p>之后用lxml中的tree来筛选源代码</p>
<p>（用xpath路径时最后要加text（）输出文本形式，不然出不了源代码）</p>
<p>xpath路径可以通过按f12控制台来提取</p>
<p><img src="https://0ha.top/img/e9d48d19e0cf422695071cff41d7ce64.png" alt=""></p>
<h3 id="获取文章的源代码">获取文章的源代码</h3>
<p>应该很好理解，就直接写代码了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">F_getyuan</span>(link_1):
</span></span><span style="display:flex;"><span>    head_qb<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;User-Agent&#39;</span>:<span style="color:#e6db74">&#39;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Mobile Safari/537.36&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    test_1<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>link_1,headers<span style="color:#f92672">=</span>head_qb)
</span></span><span style="display:flex;"><span>    test_yuan<span style="color:#f92672">=</span>test_1<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>    test_yuan<span style="color:#f92672">=</span>str(test_yuan)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> test_yuan
</span></span></code></pre></div><h3 id="提取文章目录的各个文章的链接">提取文章目录的各个文章的链接</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">F_searchlink</span>(link_2):
</span></span><span style="display:flex;"><span>    re_1<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    re_1<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(re_1)
</span></span><span style="display:flex;"><span>    link_3<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>findall(re_1,link_2)
</span></span><span style="display:flex;"><span>    link_max<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>array([])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> link_1 <span style="color:#f92672">in</span> link_3:
</span></span><span style="display:flex;"><span>        link_4<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;http://www.biquge66.net</span><span style="color:#e6db74">{</span>link_1<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>        link_max<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>append(link_max,link_4)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> link_max
</span></span></code></pre></div><p>这里我直接用re库的正则来进行匹配了匹配的链接</p>
<p>注意由于匹配的链接不是完整链接</p>
<p>所以还需要进行拼接</p>
<p><img src="https://0ha.top/img/1e462de1583f4c2aa402aec92da00252.png" alt=""></p>
<p>拼接完成后便可以直接打开</p>
<p>在这里我先存储到数组中方便之后爬取各个文章的源代码</p>
<p>然后进行返回</p>
<h2 id="总代码">总代码</h2>
<p>main.py</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#75715e"># PyQt5中使用的基本控件都在PyQt5.QtWidgets模块中</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> PyQt5.QtWidgets <span style="color:#f92672">import</span> QApplication, QMainWindow
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 导入designer工具生成的login模块</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> win <span style="color:#f92672">import</span> Ui_MainWindow
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> test_1 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyMainForm</span>(QMainWindow, Ui_MainWindow):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, parent<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        super(MyMainForm, self)<span style="color:#f92672">.</span>__init__(parent)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>setupUi(self)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>Button_close<span style="color:#f92672">.</span>clicked<span style="color:#f92672">.</span>connect(self<span style="color:#f92672">.</span>close)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>Button_run<span style="color:#f92672">.</span>clicked<span style="color:#f92672">.</span>connect(self<span style="color:#f92672">.</span>F_run)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">F_run</span>(self):
</span></span><span style="display:flex;"><span>        link_1<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>line_link<span style="color:#f92672">.</span>text()
</span></span><span style="display:flex;"><span>        title_1<span style="color:#f92672">=</span>F_gettitle(link_1)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>text_result<span style="color:#f92672">.</span>setText(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;标题获取成功——</span><span style="color:#e6db74">{</span>title_1<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># file_1=open(f&#39;{title_1}.txt&#39;,mode=&#39;w&#39;,encoding=&#39;utf-8  &#39;)</span>
</span></span><span style="display:flex;"><span>        test_1<span style="color:#f92672">=</span>F_getyuan(link_1)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>text_result<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#34;提取源代码成功&#34;</span>)
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        search_1<span style="color:#f92672">=</span>F_searchlink(test_1)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>text_result<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#34;提取文章链接成功&#34;</span>)
</span></span><span style="display:flex;"><span>        pachong(search_1,title_1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 固定的，PyQt5程序都需要QApplication对象。sys.argv是命令行参数列表，确保程序可以双击运行</span>
</span></span><span style="display:flex;"><span>    app <span style="color:#f92672">=</span> QApplication(sys<span style="color:#f92672">.</span>argv)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 初始化</span>
</span></span><span style="display:flex;"><span>    myWin <span style="color:#f92672">=</span> MyMainForm()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 将窗口控件显示在屏幕上</span>
</span></span><span style="display:flex;"><span>    myWin<span style="color:#f92672">.</span>show()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 程序运行，sys.exit方法确保程序完整退出。</span>
</span></span><span style="display:flex;"><span>    sys<span style="color:#f92672">.</span>exit(app<span style="color:#f92672">.</span>exec_())
</span></span></code></pre></div><p>test_1.py</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span><span style="color:#75715e">#获取文章标题</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">F_gettitle</span>(link_0):
</span></span><span style="display:flex;"><span>    head_qb<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;User-Agent&#39;</span>:<span style="color:#e6db74">&#39;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Mobile Safari/537.36&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    test_1<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>link_0,headers<span style="color:#f92672">=</span>head_qb)
</span></span><span style="display:flex;"><span>    test_yuan<span style="color:#f92672">=</span>test_1<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>    dom<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(test_yuan)
</span></span><span style="display:flex;"><span>    test_2<span style="color:#f92672">=</span>dom<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;/html/body/article[1]/div[2]/div[2]/h1/text()&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> test_2[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#提取源代码</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">F_getyuan</span>(link_1):
</span></span><span style="display:flex;"><span>    head_qb<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;User-Agent&#39;</span>:<span style="color:#e6db74">&#39;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Mobile Safari/537.36&#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    test_1<span style="color:#f92672">=</span>requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>link_1,headers<span style="color:#f92672">=</span>head_qb)
</span></span><span style="display:flex;"><span>    test_yuan<span style="color:#f92672">=</span>test_1<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>    test_yuan<span style="color:#f92672">=</span>str(test_yuan)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> test_yuan
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#查询所有小说章节链接</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">F_searchlink</span>(link_2):
</span></span><span style="display:flex;"><span>    re_1<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    re_1<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(re_1)
</span></span><span style="display:flex;"><span>    link_3<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>findall(re_1,link_2)
</span></span><span style="display:flex;"><span>    link_max<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>array([])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> link_1 <span style="color:#f92672">in</span> link_3:
</span></span><span style="display:flex;"><span>        link_4<span style="color:#f92672">=</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;http://www.biquge66.net</span><span style="color:#e6db74">{</span>link_1<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>        link_max<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>append(link_max,link_4)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> link_max
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># #输出文章内容</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># def F_edittxt(link_3):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     head_qb={</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         &#39;User-Agent&#39;:&#39;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Mobile Safari/537.36&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     }</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     trytimes = 3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     for i in range(trytimes):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         try:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#             proxies = None</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#             test_1=requests.get(url=link_3,headers=head_qb, verify=False, proxies=None, timeout=3)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#             if test_1.status_code == 200:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#                 break</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         except:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#             print(f&#39;requests failed {i} time&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     #提取文章链接</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     re_2=&#39;(.*?)&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     re_2=re.compile(re_2)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     #提取文章标题</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     re_3=&#39;(.*?)&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     re.compile(re_3)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     test_2=np.array([])</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     test_3=np.array([])</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     test_2=re.findall(re_2,test_1.text)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     test_3 = re.findall(re_3, test_1.text)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     #放在数组的最后一个</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     test_2=np.append(test_3,test_2)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#     return test_2</span>
</span></span></code></pre></div><h2 id="下一章内容">下一章内容</h2>
<p>最后获取了所有的章节链接了，接下来就要爬取文章了</p>
<p>本来可以一起写的（可以看到我test_1.py中注释掉的部分），但是后面发现出了一些问题</p>
<p>才有了下一章内容</p>
<p>下一章会详细说明的</p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
